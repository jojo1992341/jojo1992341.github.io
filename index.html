<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coach Progression | Pompes & Abdominaux</title>

    <!-- PWA & Mobile -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#FF4444">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon-192.png">

    <link rel="stylesheet" href="css/main.css">

</head>

<body>

    <header class="header" role="banner">
        <div class="header-content">
            <h1 class="main-title">
                <span class="title-icon" aria-hidden="true">üí™</span>
                Coach Progression
            </h1>
            <p class="subtitle">Votre programme intelligent de pompes et abdominaux</p>
        </div>
    </header>

    <main class="container" role="main">

        <!-- SECTION 1: CONFIGURATION (SETUP) -->
        <section id="setupSection" class="setup-section" aria-labelledby="setupTitle">
            <div class="card setup-card">
                <h2 id="setupTitle" class="section-title">Nouvelle Semaine</h2>

                <div class="form-group">
                    <label for="exerciseSelect" class="form-label">Exercice</label>
                    <select id="exerciseSelect" class="form-select">
                        <option value="pompes">Pompes</option>
                        <option value="abdominaux">Abdominaux</option>
                    </select>
                </div>

                <div class="form-group-row">
                    <div class="form-group">
                        <label for="maxReps" class="form-label">Max Actuel</label>
                        <input type="number" id="maxReps" class="form-input" min="1" max="999" placeholder="Ex: 20"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="targetReps" class="form-label">Objectif (Optionnel)</label>
                        <input type="number" id="targetReps" class="form-input" min="1" max="999" placeholder="Ex: 50">
                    </div>
                </div>
                <p class="form-hint" style="margin-top: -1rem; margin-bottom: 1.5rem;">Testez votre max actuel sur une
                    seule s√©rie.</p>

                <button id="generateBtn" class="btn btn-primary">
                    <span class="btn-icon" aria-hidden="true">üöÄ</span>
                    G√©n√©rer mon programme
                </button>
            </div>

            <!-- GESTION DES DONN√âES -->
            <div class="card data-card">
                <h3 class="section-title" style="font-size: 1.2rem; margin-bottom: 1rem;">Donn√©es & Sauvegarde</h3>
                <div class="data-actions">
                    <button id="exportBtn" class="btn btn-secondary">
                        üíæ Exporter (JSON)
                    </button>
                    <button id="importBtn" class="btn btn-secondary">
                        üìÇ Importer
                    </button>
                    <input type="file" id="importFile" class="hidden" accept=".json" aria-label="Fichier de sauvegarde">
                </div>
            </div>
        </section>

        <!-- SECTION 2: PROGRAMME EN COURS -->
        <section id="programSection" class="program-section hidden" aria-live="polite">

            <!-- Info Semaine & Objectif -->
            <div class="card info-card">
                <div class="chart-header" style="margin-bottom: 1.5rem;">
                    <h3 class="week-title" style="margin-bottom: 0; font-size: 1.2rem;">R√©sum√© Semaine</h3>
                    <div class="chart-controls" id="statsToggleGroup" role="group"
                        aria-label="M√©trique des statistiques">
                        <button class="chart-toggle active" data-stat-metric="max" aria-pressed="true">Perfo
                            Max</button>
                        <button class="chart-toggle" data-stat-metric="progression"
                            aria-pressed="false">Progression</button>
                        <button class="chart-toggle" data-stat-metric="volume" aria-pressed="false">Volume</button>
                    </div>
                </div>
                <div class="week-info">
                    <div class="week-badge">
                        <span class="badge-label">Semaine</span>
                        <span class="badge-number" id="weekNumber">1</span>
                    </div>
                    <div class="week-details">
                        <h3 class="week-title" id="weekTitle">Pompes</h3>
                        <div class="stats-grid" id="statsContainer">
                            <p class="week-stat">Max actuel: <strong id="weekMax">0</strong></p>
                            <div id="goalContainer" class="week-stat goal-stat hidden">
                                <span aria-hidden="true">üéØ</span> Objectif: <strong id="goalValue">0</strong>
                                <span id="predictionBadge" class="prediction-badge">üìÖ Calcul...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Explication Globale -->
            <div class="card pedagogy-card">
                <div class="chart-header" style="margin-bottom: 1.5rem;">
                    <h3 class="pedagogy-title" style="margin-bottom: 0;">
                        <span class="pedagogy-icon" aria-hidden="true">üéì</span>
                        Analyse Semaine
                    </h3>
                    <div class="chart-controls mobile-menu-toggle" id="analysisToggleGroup" role="group"
                        aria-label="Type d'analyse">
                        <button class="chart-toggle active" data-analysis="overview" aria-pressed="true">Vue
                            Globale</button>
                        <button class="chart-toggle" data-analysis="optimization"
                            aria-pressed="false">Optimisation</button>
                        <button class="chart-toggle" data-analysis="alerts" aria-pressed="false">Alertes</button>
                    </div>
                </div>
                <div id="globalExplanation" class="pedagogy-text">
                    <!-- Inject√© par JS -->
                </div>
            </div>

            <!-- Graphique avec Toggles -->
            <div class="card chart-card">
                <div class="chart-header">
                    <h3 class="program-title" style="margin-bottom: 0; font-size: 1.2rem;">Progression</h3>
                    <div class="chart-controls" role="group" aria-label="M√©trique du graphique">
                        <button class="chart-toggle active" data-metric="max" aria-pressed="true">Max</button>
                        <button class="chart-toggle" data-metric="volume" aria-pressed="false">Volume</button>
                    </div>
                </div>
                <div id="progressionChart" class="chart-container" aria-label="Graphique de progression">
                    <!-- SVG inject√© par JS -->
                </div>
            </div>

            <!-- Tableau -->
            <div class="card program-card">
                <div class="chart-header" style="margin-bottom: 1.5rem;">
                    <h3 class="program-title" style="margin-bottom: 0; font-size: 1.2rem;">Programme D√©taill√©</h3>
                    <div class="chart-controls mobile-menu-toggle" id="tableToggleGroup" role="group"
                        aria-label="Filtres du tableau">
                        <button class="chart-toggle active" data-table-filter="all" aria-pressed="true">Tous</button>
                        <button class="chart-toggle" data-table-filter="leger" aria-pressed="false">L√©ger</button>
                        <button class="chart-toggle" data-table-filter="modere" aria-pressed="false">Mod√©r√©</button>
                        <button class="chart-toggle" data-table-filter="intense" aria-pressed="false">Intense</button>
                    </div>
                </div>
                <div class="program-table-container">
                    <table class="program-table">
                        <thead>
                            <tr>
                                <th>Jour / Type</th>
                                <th>S√©ries</th>
                                <th>Reps</th>
                                <th>Repos</th>
                                <th>D√©tails & Objectif</th>
                            </tr>
                        </thead>
                        <tbody id="programTableBody">
                            <!-- Inject√© par JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Feedback -->
            <div class="card feedback-card">
                <div class="chart-header" style="margin-bottom: 1.5rem;">
                    <h3 class="feedback-title" style="margin-bottom: 0;">
                        <span class="feedback-icon" aria-hidden="true">üìù</span>
                        Suivi Quotidien
                    </h3>
                    <div class="chart-controls mobile-menu-toggle" id="feedbackToggleGroup" role="group"
                        aria-label="Filtres du suivi">
                        <button class="chart-toggle active" data-feedback-filter="all" aria-pressed="true">Tous</button>
                        <button class="chart-toggle" data-feedback-filter="completed"
                            aria-pressed="false">Compl√©t√©s</button>
                        <button class="chart-toggle" data-feedback-filter="failed" aria-pressed="false">√âchou√©s</button>
                        <button class="chart-toggle" data-feedback-filter="pending" aria-pressed="false">En
                            attente</button>
                    </div>
                </div>
                <div id="feedbackStats" class="feedback-stats"
                    style="margin-bottom: 1rem; padding: 1rem; background: rgba(255,255,255,0.03); border-radius: 8px; display: flex; gap: 1rem; flex-wrap: wrap; font-size: 0.9rem;">
                    <!-- Inject√© par JS -->
                </div>
                <div id="dailyFeedbackContainer" class="daily-feedback-container">
                    <!-- Inject√© par JS -->
                </div>
            </div>

            <!-- Actions -->
            <div class="actions-section">
                <div class="actions">
                    <button id="newWeekBtn" class="btn btn-primary">
                        <span class="btn-icon" aria-hidden="true">‚ûï</span> Nouvelle Semaine
                    </button>
                    <button id="reopenWeekBtn" class="btn btn-secondary">
                        <span class="btn-icon" aria-hidden="true">üìã</span> Semaine Actuelle
                    </button>
                    <button id="historyBtn" class="btn btn-secondary">
                        <span class="btn-icon" aria-hidden="true">üìä</span> Historique
                    </button>
                </div>
            </div>
        </section>

        <!-- SECTION 3: HISTORIQUE (MODAL) -->
        <section id="historySection" class="history-section hidden" role="dialog" aria-modal="true"
            aria-labelledby="histTitle">
            <div class="card history-card">
                <div class="history-header">
                    <h2 id="histTitle" class="section-title">Historique</h2>
                    <button id="closeHistoryBtn" class="btn btn-icon-only" aria-label="Fermer l'historique">‚úï</button>
                </div>
                <div id="historyContent" class="history-content">
                    <!-- Inject√© par JS -->
                </div>
            </div>
        </section>

    </main>

    <!-- OVERLAY TIMER -->
    <div id="timerOverlay" class="timer-overlay hidden" role="dialog" aria-modal="true" aria-label="Minuteur de repos">
        <div class="timer-card">
            <div class="timer-header">R√©cup√©ration</div>
            <div id="timerDisplay" class="timer-display" aria-live="off">00:00</div>
            <div class="timer-controls">
                <button id="addTimeBtn" class="btn btn-secondary btn-sm">+30s</button>
                <button id="skipTimerBtn" class="btn btn-primary btn-sm">Reprendre</button>
            </div>
        </div>
    </div>

    <footer class="footer">
        <p>Coach Progression ¬© 2026</p>
    </footer>

    <!-- SCRIPTS (Ordre de d√©pendance important) -->

    <!-- 1. Config & Base -->
    <script src="js/config.js"></script>

    <!-- 2. Infrastructure & Services -->
    <script src="js/services/audio.service.js"></script>
    <script src="js/services/storage.service.js"></script>
    <script src="js/services/filter.service.js"></script>
    <script src="js/services/chart.service.js"></script>
    <script src="js/services/timer.service.js"></script>

    <!-- 3. Domain Model -->
    <script src="js/models/training.model.js"></script>

    <!-- 4. Controller & Main -->
    <script src="js/app.js"></script>
    <script src="script.js"></script>
</body>

</html>